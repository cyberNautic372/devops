services:
  samba:
    image: dperson/samba
    container_name: samba-server
    restart: unless-stopped
    ports:
      - "445:445/tcp"
      - "139:139/tcp"
      - "137:137/udp"
      - "138:138/udp"
    environment:
      - TZ=Asia/Kolkata
      - USERID=1000
      - GROUPID=1000
    volumes:
      - ./samba/config:/etc/samba/external
      - ./samba/shares:/shares
      - ./samba/logs:/var/log/samba
      - /mnt/external_storage:/shares/external
      - /etc/localtime:/etc/localtime:ro
    command: >
      -p
      -u "psy;password123"
      -u "user2;password456"
      -s "public;/shares/public;yes;no;no;all;psy,user2"
      -s "private;/shares/private;yes;no;no;psy;psy"
      -s "readonly;/shares/readonly;yes;no;no;psy;psy,user2"
      -s "external;/shares/external;yes;no;no;psy;psy"
      -S
